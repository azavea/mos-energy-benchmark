!function(){"use strict";function t(o){var t={strFormat:function(t,e){var a=t;return angular.forEach(e,function(t,e){var r=new RegExp("{"+e+"}","g");a=a.replace(r,t)}),a},inViewPort:function(t){var e=o[0].documentElement.clientHeight,r=o[0].documentElement.clientWidth,a=t[0].getBoundingClientRect();return 0<=a.top&&a.bottom<=e&&0<=a.left&&a.right<=r},onPanelSnap:function(t,e){$(t[0]).parents(".panel-snap-container").on("panelsnap:finish",function(t){e(t)})}};return t}t.$inject=["$document"],angular.module("mos.utils",[]).factory("Utils",t)}(),function(){"use strict";angular.module("mos.config",[]).constant("MOSTablePrefix","mos_staging_")}(),function(){"use strict";function t(t,e){var r={user:"mos-benchmarking",uniqueColumn:"cartodb_id"};return r.yearsTable=e+"years",r.infoTable=e+"info",r.timeIndependentFields=["year_built","floor_area"],r.labels={eui:"EUI (kBtu/ft&sup2;)",emissions:"Emissions (MtCO2e)",energystar:"Energy Star",squarefeet:"Sq. Ft."},r.data={url:"https://"+r.user+".carto.com/api/v2/sql",currAllQuery:t.strFormat("SELECT  address, cartodb_id, number_of_buildings, phl_bldg_id, postal_code, primary_property_type, floor_area, sector, year_built, portfolio_bldg_id, property_name, electricity_{year} as electricity, energy_star_{year} as energy_star, fuel_oil_{year} as fuel_oil, natural_gas_{year} as natural_gas, site_eui_{year} as site_eui, source_eui_{year} as source_eui, steam_{year} as steam, total_ghg_{year} as total_ghg, water_use_{year} as water_use FROM {table}",{}),detailQuery:t.strFormat("SELECT * from {table} where {uniqueColumn} in ({id})",{uniqueColumn:r.uniqueColumn}),groupedQuery:t.strFormat("SELECT  sector as name, count(*) as count, sum(site_eui_{year}) as eui, avg(energy_star_{year}) as energystar, sum(total_ghg_{year}) as emissions, sum(site_eui_{year} * floor_area) as totalenergy FROM {table} GROUP BY sector",{}),yearsQuery:t.strFormat("SELECT * from {table} ORDER BY year DESC",{table:r.yearsTable}),infoQuery:t.strFormat("SELECT * from {table}",{table:r.infoTable})},r}t.$inject=["Utils","MOSTablePrefix"],angular.module("mos.cartodb",["mos.utils","mos.config"]).factory("CartoConfig",t)}(),function(){"use strict";function t(a,e,r,o,t,n){var i={},l={};function s(t,e){e=e||{};var r=n.strFormat(t,e);return a.get(o.data.url,{params:{q:r},cache:!0})}return i.years=[],i.allYears=[],i.getCurrentYear=c,i.getTableName=u,i.yearsData=function(){return l},i.getCurrentData=function(t){var r=[];return angular.forEach(t,function(t){var e={id:t.portfolio_bldg_id,sector:t.sector,propertyname:t.property_name,emissions:t.total_ghg,energystar:t.energy_star,eui:t.site_eui,sqfeet:t.floor_area,yearbuilt:t.year_built};r.push(e)}),r},i.getInfo=function(t){var e={};return angular.forEach(t,function(t){e[t.key]=t.value}),e},i.getAllCurrentData=function(){return s(o.data.currAllQuery,{year:c(),table:u()})},i.getGroupedData=function(){return s(o.data.groupedQuery,{year:c(),table:u()})},i.getBuildingData=function(t){var e=t;return _.isArray(t)&&(e=t.join(",")),s(o.data.detailQuery,{id:e,table:u()})},i.getInfoData=function(){return s(o.data.infoQuery)},i.getYearsData=function(){return s(o.data.yearsQuery)},i.setYears=function(t){var e=[];angular.forEach(t.data.rows,function(t){e.push(t.year),l[t.year]={downloadUrl:t.download_url,avgEnergyStar:t.avg_energy_star,ghgBuildings:t.ghg_buildings,numBuildings:t.num_buildings}}),3<=(i.allYears=e).length&&(i.years=e.slice(0,3)),r.$broadcast("mos.cartodb:years",i.years)},i;function c(){var t=parseInt(e.search().year,10);return 0<=i.years.indexOf(t)?t:i.years[0]}function u(){return t+"beb_"+i.years.slice().sort().join("_")}}t.$inject=["$http","$location","$rootScope","CartoConfig","MOSTablePrefix","Utils"],angular.module("mos.cartodb").factory("CartoSQLAPI",t)}(),function(){"use strict";function t(r){return function(t,e){return t=parseFloat(t),isNaN(t)?"N/A":r("number")(t,e)}}t.$inject=["$filter"],angular.module("mos.cartodb").filter("cartodbNumber",t)}(),function(){"use strict";function t(t){t.state("root",{abstract:!0,controller:"RootController",templateUrl:"scripts/root/root-partial.html",resolve:{yearData:["CartoSQLAPI",function(t){return t.getYearsData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.root",["ui.router","mos.cartodb","mos.headerbar","mos.utils"]).config(t)}(),function(){"use strict";function t(t,e){t.setYears(e)}t.$inject=["CartoSQLAPI","yearData"],angular.module("mos.root").controller("RootController",t)}(),function(){"use strict";angular.module("mos.headerbar",["ui.router","mos.cartodb","mos.years"])}(),function(){"use strict";function t(t){this.getYear=t.getCurrentYear}t.$inject=["CartoSQLAPI"],angular.module("mos.headerbar").controller("HeaderBarController",t)}(),function(){"use strict";angular.module("mos.headerbar").directive("mosHeaderbar",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/headerbar/headerbar-partial.html",bindToController:!0,controller:"HeaderBarController",controllerAs:"ctl"}})}(),function(){"use strict";angular.module("mos.colors",["mos.cartodb"])}(),function(){"use strict";function t(c,u,n,d){var t={},a="Building Type";function e(t,e){return t.name.localeCompare(e.name)}t.getColorByFields=function(){var r={sector:a};return angular.forEach(d,function(t,e){"marker-fill"===t.cssVal&&(r[e]=t.description)}),r},t.getSizeByFields=function(){var r={};return angular.forEach(d,function(t,e){"marker-width"===t.cssVal&&(r[e]=t.description)}),r},t.getColor=function(t,e){if(!(t in d))return"sector"===t?e in n?n[e]:n.Other:(console.error("Have no CSS defined for field: "+t),"#ddd");for(var r=d[t].bins,a=r.length-1,o=a;0<o--;){if(e<=Number(r[o].max))return r[o].markerVal}return console.error("Could not find a bin for field: "+t+" with value: "+e),r[a].markerVal};t.getLegend=function(t){var e=null;if("sector"===t)e=new cartodb.geo.ui.Legend.Custom({title:a,type:"custom",data:o()});else{var r=function(t){if(!(t in d))return console.error("Field "+t+" has no CartoCSS defined!"),{};var e=d[t].bins,r=e.length-1,a={};if(a.title=d[t].description,"marker-fill"===d[t].cssVal){a.type="choropleth",a.right=e[0].max,a.left=e[r].max,"year_built"!==t&&(a.right=Number(a.right).toLocaleString(),a.left=Number(a.left).toLocaleString()),a.colors=[];for(var o=r;0<o--;)a.colors.push(e[o].markerVal)}else a.type="bubble",a.color="DarkGrey",a.min=Number(e[r].max).toLocaleString(),a.max=Number(e[0].max).toLocaleString();return a}(t);e="bubble"===r.type?new cartodb.geo.ui.Legend.Bubble(r):new cartodb.geo.ui.Legend.Choropleth(r)}return e.render().el};var o=function(){var r=[];return angular.forEach(n,function(t,e){r.push({name:e,value:t})}),r.sort(e)};t.findSectorColor=function(t){return t in n?n[t]:n.Other},t.getFieldCartoCSS=function(t){if("sector"===t)return m();if(!(t in d))return console.error("Field "+t+" has no CartoCSS defined!"),"";for(var e=d[t].bins,r=d[t].cssVal,a=e.length,o="",n="#"+u.getTableName(),i=-1!==c.timeIndependentFields.indexOf(t)?t:t+"_"+u.getCurrentYear(),l=0;l<a;l++){var s=e[l];o+=n+" ["+i+" <= "+s.max+"] {"+r+": "+s.markerVal+";}\n"}return"marker-width"===r&&(o+=n+" ["+i+" = null] {marker-width: 0;}\n"+n+" ["+i+" = 0] {marker-width: 0;}\n"),o};var m=function(){var r="",a="#"+u.getTableName();return angular.forEach(n,function(t,e){r+=a+'[sector="'+e+'"] {marker-fill: '+t+";} "}),r};return t.baseCartoCSS=["#"+u.getTableName()+"{","marker-fill-opacity: 0.8;","marker-line-color: #FFF;","marker-line-width: 0.5;","marker-line-opacity: 1;","marker-placement: point;","marker-multi-policy: largest;","marker-type: ellipse;","marker-fill: #FF5C00;","marker-allow-overlap: true;","marker-clip: false;}"].join(["\n"]),t}t.$inject=["CartoConfig","CartoSQLAPI","MOSColors","MOSCSSValues"],angular.module("mos.colors").factory("ColorService",t)}(),function(){"use strict";angular.module("mos.years",["ui.router"])}(),function(){"use strict";function t(e,t,r,a){var o=this;o.currentYear=a.getCurrentYear(),o.years=a.years,o.updateYear=function(t){e.search("year",t),o.currentYear=a.getCurrentYear()},t.$on("mos.cartodb:years",function(t,e){o.years=e,o.currentYear=a.getCurrentYear()})}t.$inject=["$location","$scope","$window","CartoSQLAPI"],angular.module("mos.years").controller("YearSelectorController",t)}(),function(){"use strict";angular.module("mos.years").directive("mosYearSelector",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/years/year-selector-partial.html",bindToController:!0,controller:"YearSelectorController",controllerAs:"ctl"}})}(),function(){"use strict";function t(t,e){var r=this;r.years=e.allYears,r.yearsData=e.yearsData(),t.$on("mos.cartodb:years",function(){r.years=e.allYears,r.yearsData=e.yearsData()})}t.$inject=["$scope","CartoSQLAPI"],angular.module("mos.years").controller("DataDownloadController",t)}(),function(){"use strict";angular.module("mos.years").directive("mosDataDownload",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/years/data-download-partial.html",bindToController:!0,controller:"DataDownloadController",controllerAs:"ctl"}})}(),function(){"use strict";angular.module("mos.charting",["ngSanitize","mos.colors"])}(),function(){"use strict";angular.module("mos.charting").factory("ChartingUtils",function(){var t={seed:function(t,e,r){t=void 0===t?50:t,e=void 0===e?100:e,r=void 0===r?1:r;for(var a=function(){return Math.round(Math.random()*e)},o=[],n=0;n<t;n++){var i=null;if(1===r)i=a();else{i=[];for(var l=0;l<r;l++)i[l]=a()}o[n]=i}return o}};return t})}(),function(){"use strict";function t(a,o,e,r){var n={left:30,top:10,bottom:30,right:10};a.config={},a.setDefaultMargins=function(t){n=t},a.configure=function(t){angular.forEach(t,function(t,e){var r=o[e];a.config[e]=angular.isDefined(r)?a.$eval(r):t}),a.config.margin=function(t){var e=a.$eval(t)||n;"object"!=typeof e&&(e={left:e,top:e,bottom:e,right:e});return e}(o.margin),a.plotComplete=!1},a.redraw=function(t){!t||a.plotComplete||a.config.lazyLoad&&!r.inViewPort(e)||(a.plot(t),a.allowRedraw||(a.plotComplete=!0))},a.plot=function(){},a.$watch("data",function(t){a.redraw(t)}),r.onPanelSnap(e,function(){a.redraw(a.data)})}t.$inject=["$scope","$attrs","$element","Utils"],angular.module("mos.charting").controller("ChartingController",t)}(),function(){"use strict";t.$inject=["CartoSQLAPI","BarChartDefaults"];function t(t,r){var e={},b=t.getCurrentYear();return e.restrict="EA",e.templateUrl="scripts/charting/barchart-partial.html",e.controller="ChartingController",e.scope={data:"=",id:"@",plotWidth:"@",selectedY:"=",selectLabel:"=",selectUnit:"=",plotHeight:"@",margin:"&",binType:"@",lazyLoad:"@",transitionMillis:"@"},e.link=function(f,t,e){f.configure(r);var h=f.config;h.margin.left=0,h.margin.bottom=40,t.addClass("mos-barchart");var y=d3.select("#"+e.id+" .chart").attr("width",h.plotWidth).attr("height",h.plotHeight);f.plot=function(r){var t,e,a,o,n=f.selectedY;y.attr("height",h.plotHeight),"temporal"===h.binType?(t=r,e=_.reject(t,function(t){return t.yearbuilt<=1849||t.yearbuilt>b||"3634188"===t.id||"2436917"===t.id}),a=_.zip(_.range(1849,2015,5),_.range(1853,2019,5)),o=d3.nest().key(function(e){var t=_.find(a,function(t){return t[0]<=e.yearbuilt&&e.yearbuilt<=t[1]});return t[0]+" - "+t[1]}).rollup(function(t){return{totalsqft:d3.mean(t,function(t){return t.sqfeet}),avgeui:d3.mean(t,function(t){return t.eui}),totalemissions:d3.mean(t,function(t){return t.emissions}),avgenergystar:d3.mean(t,function(t){return t.energystar}),count:d3.sum(t,function(){return 1}),totalenergy:d3.sum(t,function(t){return t.eui*t.sqfeet})}}).entries(e),r=_.chain(o).sortBy(function(t){return t.key}).map(function(t){var e=t.values;return e.key=t.key,e.avgenergystar=isNaN(e.avgenergystar)?0:e.avgenergystar,e}).reverse().value()):"area"===h.binType&&(r=function(t,e){t=_.reject(t,function(t){return!t.sqfeet||t.yearbuilt>b||"3634188"===t.id||"2436917"===t.id}),_.forEach(t,function(t){t.log=Math.log(t.sqfeet)/Math.log(10)});for(var r={},c=_.max(t,function(t){return t.log}).log/e,a=function(t){return c*o<t.log&&c*o+c>=t.log},o=0;o<e;o++)r[o]=_.filter(t,a);var u=[];return _.forEach(r,function(t,e){var r=t.length,a=_.filter(t,function(t){return!isNaN(t.energystar)&&0<t.energystar}).length,o=_.filter(t,function(t){return!isNaN(t.eui)&&0<t.eui}).length,n=Math.round(Math.pow(10,e*c)),i=Math.round(Math.pow(10,e*c+c));if(t&&0<t.length){var l=_.minBy(t,function(t){return t.sqfeet}).sqfeet,s=_.maxBy(t,function(t){return t.sqfeet}).sqfeet;u=u.concat({totalemissions:_.reduce(t,function(t,e){return e.emissions+t},0),avgenergystar:0<a?_.reduce(t,function(t,e){return e.energystar+t},0)/a:0,avgeui:0<o?_.reduce(t,function(t,e){return e.eui+t},0)/o:0,minsqft:l||0,maxsqft:s||0,avgsqft:_.reduce(t,function(t,e){return e.sqfeet+t},0)/r,totalsqft:_.reduce(t,function(t,e){return e.sqfeet+t},0),totalenergy:_.reduce(t,function(t,e){return e.sqfeet*e.eui+t},0),count:r,key:n.toLocaleString()+" - "+i.toLocaleString(),yearRange:_.minBy(t,function(t){return t.yearbuilt}).yearbuilt+"-"+_.maxBy(t,function(t){return t.yearbuilt}).yearbuilt,lowBound:n,highBound:i})}}),_.tail(u,function(t){return t.lowBound<800}).reverse()}(r,62));var i,l=d3.scale.ordinal().domain(r.map(function(t){return t.key})).rangeRoundBands([h.plotWidth-h.margin.left-h.margin.right,0],.05);i="area"===h.binType?d3.scale.log().domain([r[r.length-1].lowBound,r[0].highBound]).range([0,h.plotWidth-h.margin.left-h.margin.right]):l;var s=d3.scale.linear().domain([0,d3.max(r,function(t){return t[n]})]).range([h.plotHeight-h.margin.bottom-h.margin.top,0]),c=d3.svg.axis().orient("bottom").scale(i).tickSize(3,1).ticks(5,function(t){return 10+(Math.round(Math.log(t)/Math.LN10)+"").split("").map(function(t){return"⁰¹²³⁴⁵⁶⁷⁸⁹"[t]}).join("")});"area"!==h.binType&&(c=c.tickValues([])),y.append("g").attr("class","x axis").attr("transform","translate("+h.margin.left+","+(h.plotHeight-h.margin.bottom)+")").call(c);var u=y.append("text").attr("class","x startLabel").attr("x",h.margin.left).attr("y",h.plotHeight-h.margin.top),d=y.append("text").attr("class","x endLabel").attr("x",h.plotWidth-h.margin.right).attr("y",h.plotHeight-h.margin.top),m=y.append("text").attr("class","x centerLabel").attr("x",(h.plotWidth-h.margin.right)/2).attr("y",h.plotHeight-h.margin.top);"temporal"===h.binType?(u.attr("dy","-10px").text("1850"),d.attr("dy","-10px").text(b),m.attr("dy","-10px").text("Year Built")):"area"===h.binType&&m.text("Sq. Feet ").append("tspan").attr("class","faded").text("(log scale)");var p=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return'<div class="propertyName">'+(t.key+("area"===h.binType?" Sq Ft":""))+'</div><br /><div class="propertyName">'+f.selectLabel+':</div><div class="propertyName">'+Math.round(t[n]).toLocaleString()+" "+f.selectUnit+"</div>"});function g(){var t=h.transitionMillis;s.domain([0,d3.max(r,function(t){return t[n]})]),y.selectAll("rect").transition().ease("linear").duration(t).attr("class",h.binType).attr("y",function(t){return(isNaN(t[n])?0:s(t[n]))-10+h.margin.top}).attr("height",function(t){var e=isNaN(t[n])?0:s(t[n]);return h.plotHeight-e-h.margin.top-h.margin.bottom})}y.call(p),y.selectAll("bar").data(r).enter().append("rect").attr("transform",function(t){return"translate("+(l(t.key)+h.margin.left).toString()+",0)"}).attr("y",h.plotHeight-h.margin.bottom).attr("height",0).attr("width",l.rangeBand()).attr("opacity",function(t,e){return 1-e/r.length*.3}).attr("rx",3).attr("ry",3).on("mouseover",p.show).on("mouseout",p.hide),g(),f.$watch("selectedY",function(t){n=t,g()})}},e}angular.module("mos.charting").constant("BarChartDefaults",{plotWidth:700,plotHeight:200,transitionMillis:500,lazyLoad:!0,binType:"temporal"}).directive("mosBarchart",t)}(),function(){"use strict";t.$inject=["BubbleChartDefaults","CartoConfig","MOSColors"];function t(r,t,i){var a="mos-bubblechart",l=null,s=null,c=null,e={restrict:"EA",templateUrl:"scripts/charting/bubblechart-partial.html",controller:"ChartingController",scope:{data:"=",id:"@",plotWidth:"@",plotHeight:"@",bubblePadding:"@",lazyLoad:"@",transitionTime:"@"},link:function(o,t,e){o.SELECT_CLASS=a+"-select",o.configure(r);var n=o.config;o.bubbleSeries="count",o.selectOptions={count:"Building Count",totalenergy:"Total Energy (kBtu)",emissions:"Total Emissions (MtCO2e)",energystar:"Mean Energy Star"},t.addClass(a),l=d3.select("#"+e.id+" .chart").attr("width",n.plotWidth).attr("height",n.plotHeight),s=d3.layout.pack().size([n.plotWidth,n.plotHeight]).padding(n.bubblePadding),c=d3.tip().attr("class","d3-tip").offset([-10,0]),l.call(c),o.changeSeries=function(t){o.bubbleSeries=t},o.$watch("bubbleSeries",function(){o.plotComplete=!1,o.redraw(o.data)}),o.plot=function(t){var e,r=o.bubbleSeries;if(r){c.html(function(t){return"<div>"+t.name+"</div><div>"+o.selectOptions[r]+": "+Math.round(t[r]).toLocaleString()+"</div>"}),s.sort(null).value(function(t){return t[r]||0});var a=(e=l.selectAll("g").data(s.nodes({children:t}))).enter().append("g").filter(function(t){return 1===t.depth}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).on("mouseover",c.show).on("mouseout",c.hide);a.append("circle").attr("r",0).attr("class","bubble").style("fill",function(t){return i[t.name]||i.Other}),a.append("text").attr("dy",".35em").attr("text-anchor","middle").text(function(t){return t.name}).style("opacity",0),a.append("circle").attr("r",0).attr("class","bubble2").style("opacity",0),e.transition().duration(n.transitionTime).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).selectAll("circle").attr("r",function(t){return t.r}),e.select("text").transition().duration(n.transitionTime).style("opacity",function(t){return this.getBBox().width<2*t.r-5?1:0})}}}};return e}angular.module("mos.charting").constant("BubbleChartDefaults",{plotWidth:500,plotHeight:400,bubblePadding:25,lazyLoad:!0,transitionTime:500}).directive("mosBubblechart",t)}(),function(){"use strict";t.$inject=["ColorService","ScatterPlotDefaults"];function t(h,r){var y=null,b=null,v=null,t={restrict:"EA",templateUrl:"scripts/charting/scatterplot-partial.html",controller:"ChartingController",scope:{data:"=",id:"@",plotWidth:"@",plotHeight:"@",pointFillColor:"@",pointStrokeColor:"@",xDefaultDim:"@",yDefaultDim:"@",areaDefaultDim:"@",colorDefaultDim:"@",minRadius:"@",maxRadius:"@",lazyLoad:"@",margin:"&"}};return t.link=function(g,t,e){g.configure(r);var f=g.config;g.axisOptions=h.getSizeByFields(),g.colorOptions=h.getColorByFields(),g.selected={x:f.xDefaultDim,y:f.yDefaultDim,color:f.colorDefaultDim,area:f.areaDefaultDim},g.changeSelectedOption=function(t,e){g.selected[t]=e,g.plotComplete=!1,g.redraw(g.data)},t.addClass("mos-scatterplot"),y=d3.select("#"+e.id+" .chart").attr("width",f.plotWidth).attr("height",f.plotHeight);g.plot=function(t){var e=g.selected.x,r=g.selected.y,a=g.selected.area,o=g.selected.color,n={x:g.axisOptions[e],y:g.axisOptions[r],area:g.axisOptions[a],color:g.colorOptions[o]},i=function(t){return t[e]<1?1:t[e]},l=function(t){return t[r]<1?1:t[r]},s=function(t){return t[e]<1||t[r]<1?0:Math.sqrt(t[a]/Math.PI)},c=d3.scale.log().domain([1,d3.max(t,i)]).range([f.margin.left,f.plotWidth-f.margin.right]),u=d3.scale.log().domain([1,d3.max(t,l)]).range([f.plotHeight-f.margin.bottom,f.margin.top]),d=d3.scale.linear().domain([0,d3.max(t,s)]).range([f.minRadius,f.maxRadius]);b=d3.svg.axis().orient("left").scale(u).tickValues([]),y.append("g").attr("class","y axis").attr("transform","translate("+f.margin.left+",0)").call(b),v=d3.svg.axis().orient("bottom").scale(c).tickValues([]),y.append("g").attr("class","x axis").attr("transform","translate(0, "+(f.plotHeight-f.margin.bottom)+")").call(v);var m=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return['<span><p class="propertyName">',t.property_name,'</p><p class="propertyName">',n.x,": ",t[e]?t[e].toLocaleString():"0",'</p><p class="propertyName">',n.y,": ",t[r]?t[r].toLocaleString():"0",'</p><p class="propertyName">',n.area,": ",t[a]?t[a].toLocaleString():"0",'</p><p class="propertyName">',n.color,": ","year_built"===o?t[o]:t[o].toLocaleString(),"</p></span>"].join("")});y.call(m);var p=y.selectAll("circle").data(t).on("mouseover",m.show).on("mouseout",m.hide);p.enter().append("circle").attr("cx",function(t){return c(i(t))}).attr("cy",function(t){return u(l(t))}).attr("r",0).attr("fill",f.pointFillColor).on("mouseover",m.show).on("mouseout",m.hide),p.exit().remove(),p.transition().duration(2e3).attr("cx",function(t){return c(i(t))}).attr("cy",function(t){return u(l(t))}).attr("fill",function(t){return h.getColor(o,t[o])}).attr("r",function(t){return d(s(t))}),function(){$("div.cartodb-legend.choropleth").remove(),$("div.cartodb-legend.custom").remove();var t=$("#scatterplot");$(t).append(h.getLegend(g.selected.color))}()}},t}angular.module("mos.charting").constant("ScatterPlotDefaults",{plotWidth:800,plotHeight:400,pointFillColor:"#14bfd6",pointStrokeColor:"#ddd",xDefaultDim:"site_eui",yDefaultDim:"total_ghg",areaDefaultDim:"electricity",colorDefaultDim:"sector",minRadius:3,maxRadius:10,lazyLoad:!0}).directive("mosScatterplot",t)}(),function(){"use strict";t.$inject=["CartoConfig","HistogramDefaults","$filter"];function t(t,a,k){var e={};return e.restrict="EA",e.template='<svg class="chart"></svg>',e.controller="ChartingController",e.scope={data:"=",id:"@",plotWidth:"@",plotHeight:"@",plotWidthPercentage:"@",barRadius:"@",valueField:"@",margin:"&",calloutValues:"=",calloutColors:"=",labels:"=",transitionMillis:"@",allowRedraw:"@",lazyLoad:"@"},e.link=function(e,t,r){e.setDefaultMargins(10),e.configure(a);var f=e.config,h=f.margin,y=e.calloutValues,b=e.calloutColors,v=e.labels;t.addClass("mos-histogram");var C=r.id;C||(C="mos-histogram-"+Math.floor(1000000001*Math.random()).toString(),t.attr("id",C));var x=d3.select("#"+C+" .chart").attr("width",f.plotWidth).attr("height",f.plotHeight).append("g").attr("transform","translate("+h.left+","+h.top+")");e.$watch("calloutValues",function(t){y=t,e.redraw(e.data)}),e.plot=function(t){d3.selectAll("#"+C+" .chart > g > *").remove(),t=_.chain(t).filter(function(t){return 1<=t[f.valueField]}).map(function(t){return Math.log(t[f.valueField])/Math.log(10)}).value();var r,e,a,o=_.max(t),n=_.min(t),i=f.plotHeight-h.top-h.bottom,l=f.plotWidth-h.left-h.right,s=d3.scale.linear().domain([n,o]).range([0,l]),c=d3.scale.linear().domain([0,1]).range([i,30]),u=(a=.3,r=function(t){return Math.abs(t/=a)<=1?.75*(1-t*t)/a:0},e=s.ticks(100),function(t){return e.map(function(e){return[e,d3.mean(t,function(t){return r(e-t)})]})})(t),d=d3.svg.area().x(function(t){return s(t[0])}).y0(i).y1(function(t){return c(t[1])});x.append("path").datum(u).attr("class","kde plot").attr("d",d);var m=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){for(var e="<span>",r=0;r<y.length;r++){var a=y[r];e+=["<p ",b[r]?'style="color:'+b[r]+';"':'"',a===t?' class="underline"':"",">",v[r],": ",k("cartodbNumber")(a,0),"</p>"].join("")}return e+="</span>"});x.call(m);for(var p=0;p<y.length;p++)if(null!==y[p]){var g=s(1<=y[p]?Math.log(y[p])/Math.log(10):n);x.append("rect").attr("x",g).attr("y",0).attr("height",i).attr("width","2px").attr("fill",b[p]||"DarkGray")}x.selectAll("rect").data(y).on("mouseover",m.show).on("mouseout",m.hide)}},e}angular.module("mos.charting").constant("HistogramDefaults",{plotWidth:200,plotHeight:80,plotWidthPercentage:.8,barRadius:4,valueField:"",transitionMillis:500,lazyLoad:!1}).directive("mosHistogram",t)}(),function(){"use strict";angular.module("mos.compare",["ngCookies"])}(),function(){"use strict";function t(a){var o="mos.compare.buildingcompare.compareids",n=a.get(o)||[],t={add:function(t){"string"==typeof t&&-1===_.indexOf(n,t)&&(n.push(t),a.put(o,n))},remove:function(t){if("string"!=typeof t)return null;var e=_.indexOf(n,t),r=null;return-1!==e&&(r=n.splice(e,1),a.put(o,n)),r},hasId:function(t){return-1!==_.indexOf(n,t)},list:function(){return n},count:function(){return n.length},clear:function(){n=[],a.remove(o)}};return t}t.$inject=["$cookieStore"],angular.module("mos.compare").factory("BuildingCompare",t)}(),function(){"use strict";angular.module("mos.mapping",["mos.cartodb","mos.colors"])}(),function(){"use strict";function t(r,a,o,e,t){var n="-75.699037,40.195219,-74.886736,39.774326",i=[],l={FILTER_NONE:"All types"},s=t.getTableName(),c=function(e){return _.filter(i,function(t){return t&&"function"==typeof t.indexOf&&-1!==t.indexOf(e)})};return l.getBldgCategories=function(){return new cartodb.SQL({user:e.user}).execute("SELECT DISTINCT sector FROM {{tbl}} order by sector;",{tbl:s})},l.featureLookup=function(t){return new cartodb.SQL({user:e.user}).execute("SELECT * FROM {{tbl}} where cartodb_id = {{id}}",{id:t,tbl:s})},l.featureLookupByBldgId=function(t){return new cartodb.SQL({user:e.user}).execute("SELECT * FROM {{tbl}} where phl_bldg_id = '{{bldgId}}';",{bldgId:t,tbl:s})},l.getBuildingIds=function(){return new cartodb.SQL({user:e.user}).execute("SELECT DISTINCT phl_bldg_id FROM {{tbl}};",{tbl:s})},l.filterViz=function(t,e){t?e===l.FILTER_NONE?t.setSQL("SELECT * FROM "+s+";"):t.setSQL("SELECT * FROM "+s+" WHERE sector ='"+e+"';"):console.error("cannot filter; there is no viz!")},l.setVizCartoCSS=function(t,e,r){if(t){var a=o.baseCartoCSS+" "+o.getFieldCartoCSS(e)+" "+o.getFieldCartoCSS(r);t.setCartoCSS(a)}else console.error("cannot change CartoCSS; there is no viz!")},l.geocode=function(t){var e=a.defer();return r.get("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates",{params:{singleLine:t,searchExtent:n,category:"Address,Postal",outFields:"StAddr,City,Postal",maxLocations:1,f:"pjson"}}).then(function(t){e.resolve(t.data.candidates)},function(){e.resolve([])}),e.promise},l.suggest=function(e){return r.get("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/suggest",{params:{text:e,searchExtent:n,category:"Address,Postal",f:"pjson"}}).then(function(t){return c(e).slice(0,5).concat(_.map(t.data.suggestions,"text"))},function(){return c(e).slice(0,5)})},l.getBuildingIds().done(function(t){i=_.map(t.rows,"phl_bldg_id")}),l}t.$inject=["$http","$q","ColorService","CartoConfig","CartoSQLAPI"],angular.module("mos.mapping").factory("MappingService",t)}(),function(){"use strict";function t(t){t.state("charts",{parent:"root",url:"/?year",templateUrl:"scripts/views/charts/charts-partial.html",controller:"ChartsController"})}t.$inject=["$stateProvider"],angular.module("mos.views.charts",["ui.router","mos.cartodb","mos.root","mos.charting","mos.utils"]).config(t)}(),function(){"use strict";angular.module("mos.charting").directive("mosPanelSnap",function(){var t={restrict:"A",link:function(a,o,t){o.panelSnap(),o.find("[mos-panel-snap-next]").click(function(t){t.preventDefault(),t.stopPropagation(),o.panelSnap("snapTo","next")}),function(){var t=$(".header")[0],e={offset:120,scroller:o[0],onTop:function(){a.$broadcast("header:on-top")},onNotTop:function(){a.$broadcast("header:on-not-top")}};if("undefined"!=typeof Headroom){var r=new Headroom(t,e);r.init()}}()}};return t})}(),function(){"use strict";function t(t){var e={scope:{page:"@"},restrict:"EA",templateUrl:"scripts/views/charts/charts-glossary-partial.html",link:function(t,e,r){"charts"===t.page&&(e.hide(),t.$on("header:on-not-top",function(t){e.show()}),t.$on("header:on-top",function(t){e.hide()}))}};return e}t.$inject=["Utils"],angular.module("mos.charting").directive("mosChartsGlossary",t)}(),function(){"use strict";function t(d,m){var t={restrict:"A",link:function(t,e,r){var a=0,o=0,n=parseInt(r.mosCountUp,10),i=1e3*parseFloat(r.seconds||1),l=Math.ceil(i/30),s=n/l,c=null;m.onPanelSnap(e,function(){!c&&m.inViewPort(e)&&u()});var u=function(){c=d(function(){a+=s,l<=++o?(d.cancel(c),a=n,e[0].textContent=a.toLocaleString()):(e[0].textContent=Math.round(a).toLocaleString(),u())},30)}}};return t}t.$inject=["$timeout","Utils"],angular.module("mos.charting").directive("mosCountUp",t)}(),function(){"use strict";angular.module("mos.charting").directive("mosBarview",function(){var t={restrict:"EA",templateUrl:"scripts/views/charts/barview-partial.html",scope:{data:"="},link:function(e){e.selectOptions={count:"Building Count",totalenergy:"Total Energy (kBtu)",totalemissions:"Total Emissions (MtCO2e)",avgenergystar:"Mean Energy Star"};var r={totalenergy:"BTUs",totalemissions:"",avgenergystar:"",count:""};e.selectedY="totalenergy",e.selectLabel=e.selectOptions[e.selectedY],e.selectUnit=r[e.selectedY],e.$watch("selectedY",function(t){e.selectLabel=e.selectOptions[t],e.selectUnit=r[t]}),e.selectedYChanged=function(t){e.selectedY=t}}};return t})}(),function(){"use strict";t.$inject=["$scope","$cookieStore","$q","CartoSQLAPI"];var e="mos.charts.slideCallout.hide";function t(r,t,a,o){r.loadingView=!0,r.currentData=[],r.currentAllData=[],r.groupedData=[],r.hideCallout=t.get(e)||!1,r.calloutClicked=function(){t.put(e,!0),r.hideCallout=!0};!function(){r.dataYear=o.getCurrentYear(),r.reportYear=r.dataYear+1,r.stats=o.yearsData()[r.dataYear];var t=o.getAllCurrentData().then(function(t){r.currentAllData=t.data.rows}),e=o.getGroupedData().then(function(t){r.groupedData=t.data.rows});a.all([t,e]).then(function(){r.currentData=o.getCurrentData(r.currentAllData),r.loadingView=!1})}()}angular.module("mos.views.charts").controller("ChartsController",t)}(),function(){"use strict";function t(t){t.state("map",{parent:"root",url:"/map?year",templateUrl:"scripts/views/map/map-partial.html",controller:"MapController",resolve:{infoData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getInfoData().then(function(t){return r.getInfo(t.data.rows)})}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.map",["ngSanitize","ui.router","ui.bootstrap","mos.cartodb","mos.root","mos.compare","mos.colors","mos.mapping"]).config(t)}(),function(){"use strict";function t(l,t,s,e,r,a,o,n,i,c,u,d,m){s.mapLoading=!0;s.loadingView=!1;var p=null,g=null;s.getYear=i.getCurrentYear,s.years=i.years.slice(0,2).sort(),s.popupLoading=!0,s.compare={count:o.count(),isChecked:!1,disabled:!1},s.buildingTypes=[],s.filterType=u.FILTER_NONE,s.searchText="",s.noResults=!1,s.amSearching=!1,s.colorByTypes=c.getColorByFields(),s.sizeByTypes=c.getSizeByFields(),s.selections={colorType:"sector",sizeType:"site_eui",filterType:u.FILTER_NONE};var f=function(e){e?(s.propertyData={cartodbId:e.cartodb_id.toString(),buildingId:e.phl_bldg_id,propertyName:e.property_name,floorArea:e.floor_area,address:e.address,sector:e.sector},angular.forEach(s.years,function(t){s.propertyData["totalGhg"+t]=e["total_ghg_"+t],s.propertyData["siteEui"+t]=e["site_eui_"+t],s.propertyData["energyStar"+t]=e["energy_star_"+t]}),s.propertyData.sectorColor=c.findSectorColor(s.propertyData.sector)):s.propertyData={cartodbId:"",buildingId:"",propertyName:"",address:"",floorArea:"",totalGhg:"",siteEui:"",energyStar:"",sector:"",sectorColor:"transparent"}};f(null),s.clearErrorMsg=function(){s.noResults=!1,s.amSearching=!1},s.suggest=function(){s.noResults=!1,s.amSearching=!0;var e=t.defer();return u.suggest(s.searchText).then(function(t){t.length||(s.noResults=!0),e.resolve(t)},function(){s.noResults=!0,e.resolve([])}).finally(function(){s.amSearching=!1}),e.promise},s.searchMap=function(){if(s.amSearching=!0,!s.searchText||s.searchText.length<5)return s.noResults=!0,void(s.amSearching=!1);isNaN(s.searchText)?u.geocode(s.searchText).then(function(t){if(!t.length)return console.error("Could not find address!"),s.noResults=!0,void(s.amSearching=!1);var e=t[0],r=e.location,a=L.latLng(r.y,r.x);g.setView(a,16),s.noResults=!1,s.amSearching=!1;var o=['<span class="featurePopup"><div class="headerPopup geocodePopup"></div>','<div class="popupContent"><p>{{::geocodedDisplayName}}</p></div></span>'].join(""),n=e.attributes;s.geocodedDisplayName=[n.StAddr,n.City,n.Postal].join(", ");var i=l(o)(s);L.popup({minWidth:200}).setLatLng(a).setContent(i[0]).openOn(g)},function(t){console.error(t),s.amSearching=!1,s.noResults=!0}):u.featureLookupByBldgId(s.searchText).done(function(t){if(!t.rows||t.rows.length<1)return s.noResults=!0,void(s.amSearching=!1);var e=t.rows[0];f(e);var r=L.latLng(e.y_coord,e.x_coord);g.setView(r,16),s.popupLoading=!1,s.amSearching=!1,y(r)}).error(function(t){console.error("errors fetching property by building ID: "+t),f(null),s.popupLoading=!1,s.amSearching=!1,s.noResults=!0})},s.filterBy=function(t){s.selections.filterType=t,u.filterViz(p,t)},s.setSelection=function(t,e){s.selections[t]=e,u.setVizCartoCSS(p,s.selections.colorType,s.selections.sizeType),b()},s.setCompare=function(t){o.count()<3&&s.compare.isChecked?o.add(t):s.compare.isChecked||o.remove(t),s.compare.count=o.count()},s.gotoCompare=function(){e.go("compare",{ids:o.list().join(","),year:s.getYear()})};var h=['<span class="featurePopup">','<div ng-show="popupLoading" class="spinner">','<div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>','<div ng-hide="popupLoading"><div class="headerPopup" ',"ng-style=\"{'background-color': '{{::propertyData.sectorColor}}' }\">","<h4>{{::propertyData.propertyName}}</h4>",'<p class="popup-header">OPA Number: {{::propertyData.buildingId}}</p>','<p class="popup-header" ng-if="propertyData.address !== propertyData.propertyName">',"{{::propertyData.address}}</p>",'<p class="popup-header">{{::propertyData.floorArea.toLocaleString()}} sq ft</p></div>','<div class="popupContent">','<div class="row">','<div class="col-sm-5" ng-repeat="year in years">','<h4 class="text-center">{{::year}}</h4><hr />','<p>Site EUI: <strong>{{::propertyData["siteEui" + year]  | cartodbNumber:0}}</strong></p>','<p>Emissions: <strong>{{::propertyData["totalGhg" + year] | cartodbNumber:0}}</strong></p>','<p>Energy Star: <strong>{{::propertyData["energyStar" + year] | cartodbNumber:0}}</strong></p>',"</div>","</div>","<br>",'<p><label><input type="checkbox" ng-model="compare.isChecked" ','ng-disabled="compare.disabled" ','ng-change="setCompare(propertyData.cartodbId)" /> <em>Compare</em></label>','<button type="button" class="pull-right btn btn-popover" ',"ng-style=\"{'background-color': '{{::propertyData.sectorColor}}',  'opacity': 0.8 }\" ",'ui-sref="detail({buildingId: propertyData.cartodbId, year: getYear() })">Full Report</button></p>',"</div></div></span>"].join(""),y=function(t){s.compare.isChecked=o.hasId(s.propertyData.cartodbId),s.compare.disabled=!s.compare.isChecked&&3<=o.count();var e=l(h)(s);s.$apply(),L.popup({minWidth:380}).setLatLng(t).setContent(e[0]).openOn(g)};u.getBldgCategories().done(function(t){s.buildingTypes=[u.FILTER_NONE],angular.forEach(t.rows,function(t){s.buildingTypes.push(t.sector)})}).error(function(t){console.error("errors fetching property types: "+t),s.buildingTypes=[u.FILTER_NONE]});var b=function(){$("div.cartodb-legend.bubble").remove(),$("div.cartodb-legend.choropleth").remove(),$("div.cartodb-legend.custom").remove(),$("#mymap").append(c.getLegend(s.selections.sizeType)),$("#mymap").append(c.getLegend(s.selections.colorType))};a.onStart({},function(){r(function(){s.loadingView=!0},300)});var v=d.strFormat("https://{user}.carto.com/api/v2/viz/{viz}/viz.json",{user:n.user,viz:m.visualization});cartodb.createVis("mymap",v,{infowindow:!1,legends:!1,searchControl:!1,loaderControl:!0,layer_selector:!1}).done(function(t,e){var r=e[1].getSubLayers();angular.forEach(r,function(t){t.hide()}),s.mapLoading=!1,g=t.getNativeMap();var a=e[1];(p=a.getSubLayer(i.years.indexOf(s.getYear()))).show(),p.setInteraction(!0),p.on("mouseover",function(){$(".leaflet-container").css("cursor","pointer")}),p.on("mouseout",function(){$(".leaflet-container").css("cursor","-webkit-grab"),$(".leaflet-container").css("cursor","-moz-grab")}),b(),p.on("featureClick",function(t,r,e,a){s.popupLoading=!0,y(r),u.featureLookup(a.cartodb_id).done(function(t){var e=t.rows[0];f(e),s.popupLoading=!1,y(r)}).error(function(t){console.error("errors fetching property data: "+t),f(null),s.popupLoading=!1})})})}t.$inject=["$compile","$q","$scope","$state","$timeout","$transitions","BuildingCompare","CartoConfig","CartoSQLAPI","ColorService","MappingService","Utils","infoData"],angular.module("mos.views.map").controller("MapController",t)}(),function(){"use strict";function t(t){t.state("info",{parent:"root",url:"/info?year",templateUrl:"scripts/views/info/info-partial.html",controller:"InfoController",resolve:{infoData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getInfoData().then(function(t){return r.getInfo(t.data.rows)})}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.info",["ui.router","mos.cartodb","mos.root"]).config(t)}(),function(){"use strict";function t(r,t,e){function a(t){if(t&&1<t.length){var e=t.slice().reverse();r.yearsString=[_.dropRight(e,1).join(", "),", and ",_.last(e)].join("")}}r.info=e,r.yearsString="",a(t.years),r.getPrettyUrl=function(t){var e=_.split(t,"//");return e&&1<e.length?e[1]:t},r.$on("mos.cartodb:years",function(t,e){a(e)})}t.$inject=["$scope","CartoSQLAPI","infoData"],angular.module("mos.views.info").controller("InfoController",t)}(),function(){"use strict";function t(t){t.state("detail",{parent:"root",url:"/detail/:buildingId?year",templateUrl:"scripts/views/detail/detail-partial.html",controller:"DetailController",resolve:{buildingData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getBuildingData(e.buildingId)}],currentData:["yearData","CartoSQLAPI",function(t,e){return e.setYears(t),e.getAllCurrentData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.detail",["ui.router","mos.cartodb","mos.root","mos.charting"]).config(t)}(),function(){"use strict";t.$inject=["$scope","CartoSQLAPI","DetailConfig","MOSColors","MOSCSSValues","buildingData","currentData"];function t(r,t,e,a,o,n,i){var l=n.data&&n.data.rows&&0<n.data.rows.length?n.data.rows[0]:{},s=a[l.sector]||a.Other,c=i.data.rows;r.years=t.years,r.selectedYear=t.getCurrentYear(),r.yearsAscending=t.years.slice().sort(),r.building=l,r.fields=e.fields,r.currentData=c,r.cssValues=o,r.filterField="sector",r.FILTER=e.FILTER,r.dropdownText={},r.dropdownText[e.FILTER.NONE]="All Buildings",r.dropdownText[e.FILTER.SECTOR]="Similar Building Types",r.filterButtonText=r.dropdownText[e.FILTER.NONE],r.headerColor={"background-color":s,opacity:.8},r.filterBy=function(t){t===e.FILTER.SECTOR?r.currentData=_.filter(c,function(t){return t.sector===l.sector}):r.currentData=c,r.filterButtonText=r.dropdownText[t]},r.getCalloutValues=function(e){return _.map(r.years,function(t){return l[e+"_"+t]?l[e+"_"+t]:"N/A"})},r.getCalloutColors=function(){return _.map(r.years,function(t){return t===r.selectedYear?s:""})}}angular.module("mos.views.detail").constant("DetailConfig",{fields:["energy_star","site_eui","total_ghg","electricity","natural_gas","fuel_oil","steam","water_use"],FILTER:{NONE:"none",SECTOR:"sector"}}).controller("DetailController",t)}(),function(){"use strict";function t(t){t.state("compare",{parent:"root",url:"/compare?ids?year",templateUrl:"scripts/views/compare/compare-partial.html",controller:"CompareController",resolve:{buildingData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){r.setYears(t);var a=e.ids.split(",").slice(0,3);return r.getBuildingData(a)}],currentData:["yearData","CartoSQLAPI",function(t,e){return e.setYears(t),e.getAllCurrentData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.compare",["ui.router","mos.cartodb","mos.root","mos.compare","mos.charting"]).config(t)}(),function(){"use strict";t.$inject=["$location","$scope","BuildingCompare","CartoSQLAPI","CompareConfig","MOSCSSValues","buildingData","currentData"];function t(o,n,i,t,l,e,r,a){var s=t.getCurrentYear(),c=function(r,t){var a={};return angular.forEach(t,function(t){a[t]=[];for(var e=0;e<r.length;e++)a[t].push(r[e][t+"_"+s])}),a};n.year=s,n.buildings=r.data.rows,n.buildingNames=_.map(n.buildings,"property_name"),n.fields=l.fields,n.currentData=a.data.rows,n.cssValues=e,n.calloutColors=["#8FBD84","#81ABCC","#DD8180"],n.calloutValues=c(n.buildings,l.fields),n.close=function(t){var e=n.buildings[t].cartodb_id.toString();i.remove(e),n.buildings.splice(t,1),n.buildingNames.splice(t,1),n.calloutValues=c(n.buildings,l.fields);var r=o.search().ids;if(r){r=r.split(",");var a=_.indexOf(r,e);-1<a&&(r.splice(a,1),o.search("ids",r.join(",")))}}}angular.module("mos.views.compare").constant("CompareConfig",{fields:["energy_star","site_eui","total_ghg","electricity","natural_gas","fuel_oil","steam","water_use"]}).controller("CompareController",t)}(),function(){"use strict";function t(t){t.otherwise("/")}t.$inject=["$urlRouterProvider"];angular.module("mos",["mos.root","mos.headerbar","mos.views.charts","mos.views.map","mos.views.info","mos.views.detail","mos.views.compare","mos.years","headroom"]).config(t),angular.module("mos").constant("MOSColors",{"School (K-12)":"#A6CEE3",Office:"#1F78B4","Medical Office":"#52A634",Warehouse:"#B2DF8A","College/ University":"#33A02C",Other:"#FB9A99",Retail:"#E31A1C",Municipal:"#FDBF6F",Multifamily:"#FF7F00",Hotel:"#CAB2D6",Industrial:"#6A3D9A",Worship:"#9C90C4",Supermarket:"#E8AE6C",Parking:"#62afe8",Laboratory:"#3AA3FF",Hospital:"#C6B4FF","Data Center":"#a3d895"}),angular.module("mos").constant("MOSCSSValues",{energy_star:{cssVal:"marker-width",description:"Energy Star",bins:[{max:"100",markerVal:25},{max:"90",markerVal:23.3},{max:"80",markerVal:21.7},{max:"70",markerVal:20},{max:"60",markerVal:18.3},{max:"51",markerVal:16.7},{max:"41",markerVal:15},{max:"31",markerVal:13.3},{max:"21",markerVal:11.7},{max:"11",markerVal:10}]},floor_area:{cssVal:"marker-fill",description:"Square Footage",bins:[{max:"13000000",markerVal:"#91003F"},{max:"405095",markerVal:"#CE1256"},{max:"212892",markerVal:"#E7298A"},{max:"135825",markerVal:"#DF65B0"},{max:"98679",markerVal:"#C994C7"},{max:"75318",markerVal:"#D4B9DA"},{max:"59200",markerVal:"#F1EEF6"}]},year_built:{cssVal:"marker-fill",description:"Year Built",bins:[{max:"2014",markerVal:"#0C2C84"},{max:"1993",markerVal:"#225EA8"},{max:"1972",markerVal:"#1D91C0"},{max:"1952",markerVal:"#41B6C4"},{max:"1932",markerVal:"#7FCDBB"},{max:"1912",markerVal:"#C7E9B4"},{max:"1889",markerVal:"#FFFFCC"}]},site_eui:{cssVal:"marker-width",description:"EUI (kBtu/ft&sup2;)",bins:[{max:"2523",markerVal:"25.0"},{max:"240.4",markerVal:"23.3"},{max:"159.9",markerVal:"21.7"},{max:"119.8",markerVal:"20.0"},{max:"99.3",markerVal:"18.3"},{max:"83.3",markerVal:"16.7"},{max:"69.5",markerVal:"15.0"},{max:"55.9",markerVal:"13.3"},{max:"39.7",markerVal:"11.7"},{max:"16.3",markerVal:"10.0"}]},total_ghg:{cssVal:"marker-width",description:"Emissions (MtCO2e)",bins:[{max:"258330",markerVal:"25.0"},{max:"5311.3",markerVal:"23.3"},{max:"2593.9",markerVal:"21.7"},{max:"1671",markerVal:"20.0"},{max:"1129.4",markerVal:"18.3"},{max:"825.7",markerVal:"16.7"},{max:"598.2",markerVal:"15.0"},{max:"429.6",markerVal:"13.3"},{max:"316.5",markerVal:"11.7"},{max:"126.5",markerVal:"10.0"}]},electricity:{cssVal:"marker-width",description:"Electricity (kBtu)",bins:[{max:"1068323130",markerVal:"25.0"},{max:"27948794.1",markerVal:"23.3"},{max:"14378246.5",markerVal:"21.7"},{max:"9657079.1",markerVal:"20.0"},{max:"6267008.1",markerVal:"18.3"},{max:"4535964",markerVal:"16.7"},{max:"2975929.7",markerVal:"15.0"},{max:"2005814.5",markerVal:"13.3"},{max:"1164578",markerVal:"11.7"},{max:"638726.4",markerVal:"10.0"}]},fuel_oil:{cssVal:"marker-width",description:"Fuel Oil (kBtu)",bins:[{max:"35790575",markerVal:"25.0"},{max:"9401723.3",markerVal:"23.3"},{max:"6210505.9",markerVal:"21.7"},{max:"4234237",markerVal:"20.0"},{max:"3741594.1",markerVal:"18.3"},{max:"3355132.4",markerVal:"16.7"},{max:"2418174.1",markerVal:"15.0"},{max:"1690707",markerVal:"13.3"},{max:"847996",markerVal:"11.7"},{max:"175893.5",markerVal:"10.0"}]},natural_gas:{cssVal:"marker-width",description:"Natural Gas (kBtu)",bins:[{max:"1123733030",markerVal:"35.0"},{max:"16996373.8",markerVal:"32.2"},{max:"7030613.2",markerVal:"29.4"},{max:"4607952.6",markerVal:"26.7"},{max:"3306190.9",markerVal:"23.9"},{max:"2201595.2",markerVal:"21.1"},{max:"1386463.6",markerVal:"18.3"},{max:"765205.4",markerVal:"15.6"},{max:"323197.2",markerVal:"12.8"},{max:"115650",markerVal:"10.0"}]},water_use:{cssVal:"marker-width",description:"Water Use (kgal)",bins:[{max:"700949.4",markerVal:"35.0"},{max:"14733.6",markerVal:"32.2"},{max:"7137.9",markerVal:"29.4"},{max:"3943",markerVal:"26.7"},{max:"2349.3",markerVal:"23.9"},{max:"1345",markerVal:"21.1"},{max:"904.9",markerVal:"18.3"},{max:"611.4",markerVal:"15.6"},{max:"328.3",markerVal:"12.8"},{max:"112.7",markerVal:"10.0"}]},steam:{cssVal:"marker-width",description:"Steam (kBtu)",bins:[{max:"1375885588",markerVal:"25.0"},{max:"33787072",markerVal:"23.3"},{max:"20344457.7",markerVal:"21.7"},{max:"14335164",markerVal:"20.0"},{max:"11635695.2",markerVal:"18.3"},{max:"9132222.5",markerVal:"16.7"},{max:"6982731.5",markerVal:"15.0"},{max:"5334792",markerVal:"13.3"},{max:"3599831.1",markerVal:"11.7"},{max:"1982704.8",markerVal:"10.0"}]}})}(),function(){"use strict";function t(r){var t={restrict:"A",link:function(t,e){r.onStart({},function(){e.addClass("headroom headroom--top"),e.removeClass("headroom--not-top headroom--unpinned headroom--pinned")})}};return t}t.$inject=["$transitions"],angular.module("mos").directive("headroomReset",t)}();